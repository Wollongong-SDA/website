---
import BaseLayout from '../../layouts/BaseLayout.astro'
import Verse from '../../components/Verse.astro'
import RightImageHero from '../../components/RightImageHero.astro'
import TextBlock from '../../components/TextBlock.astro'
import Button from '../../components/Button.astro'
import { Markdown } from 'astro-remote'
import { shortcutsExtension } from '../../lib/markdown'
import { getCollection } from 'astro:content'

export async function getStaticPaths() {
  const pages = await getCollection('locations')
  return pages.map((page) => ({
    params: { slug: page.data.slug },
    props: { page },
  }))
}

const quote = {
  text: `Accept one another, then, just as Christ accepted you, in order to bring praise to God.`,
  reference: 'Romans 15:7 (NIV)',
}

const page = Astro.props.page.data

const ld = {
  '@context': 'https://schema.org',
  '@type': 'Church',
  name: page.name + ' Seventh-day Adventist Church',
  photo: [page.background],
  url: Astro.request.url,
}
---

<BaseLayout title={page.name} jsonld={[ld]} description={page.overview}>
  <RightImageHero headingImage={page.logo + '.svg'} image={page.background}>
    {page.overview}
  </RightImageHero>
  <TextBlock>
    <Markdown
      content={page.content as string}
      sanitize={{ allowComponents: true }}
      components={{ Button }}
      marked={{ extensions: [shortcutsExtension()] }}
    />
  </TextBlock>
  <Verse text={quote.text} reference={quote.reference} />
</BaseLayout>
